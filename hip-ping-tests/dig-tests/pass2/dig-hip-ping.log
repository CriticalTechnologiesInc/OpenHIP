OpenHIP v0.9 HIP daemon
init_tap()
Sat Apr 20 14:36:48 2019 (4) hipd v0.9 (1170) started.
Setting options: daemon = no  debug level = 1  permissive = no
     no_retransmit = no  opportunistic = no any = no rvs = no mr = no
Using configuration file:	/usr/local/etc/hip/hip.conf
Using my host IDs file:		/usr/local/etc/hip/my_host_identities.xml
My host identities:
 HI: dig-1024 HIT: 2001:1e:4aef:5a38:f397:8f52:b607:bad5
	LSI: 1.7.186.213 
Using known host IDs file:	/usr/local/etc/hip/known_host_identities.xml
Known peer host identities:
 HIT: jokey-1024  2001:11:9856:d864:d13d:411:14:22ce
	LSI: 1.20.34.206 [192.168.100.3 ]
 HIT: adam-desktop-1024  2001:1b:574c:56ab:6498:6726:a858:35ea
	LSI: 1.88.53.234 [192.168.4.89 ]
Using TAP device hip0.
Initialized TAP device.
hip_esp_input() thread started...
hip_status() thread started...
Local addresses: (1)127.0.0.1 (4)192.168.100.2 (1)::1 (4)fe80::20d:b9ff:fe42:73b6 
192.168.100.2 selected as the preferred address (first in list).
hip_esp_output() thread started...
tunreader() thread started (3)...
Initializing R1 cache entries for identity dig-1024 (8 slots).
Adding address 1.7.186.213 to interface 8.
Adding address 2001:1e:4aef:5a38:f397:8f52:b607:bad5 to interface 8.
Sat Apr 20 14:36:49 2019 (1) Listening for HIP control packets...
Sat Apr 20 14:36:50 2019  HIP threads initialization completed.
Sat Apr 20 14:37:03 2019 (1) Received ACQUIRE for LSI 1.20.34.206 creating new association.
Adding address 192.168.100.2 to association.
Sat Apr 20 14:37:03 2019 (4) Base exchange initiated from 
	2001:1e:4aef:5a38:f397:8f52:b607:bad5 / 192.168.100.2 / 1.7.186.213 to 
	2001:11:9856:d864:d13d:411:14:22ce / 192.168.100.3 / 1.20.34.206
 20010011 9856d864 d13d0411 001422ceSending HIT corresponding to 192.168.100.3.
Sat Apr 20 14:37:03 2019 (1) Sending HIP_I1 packet (40 bytes)...
Sat Apr 20 14:37:03 2019 (1) Sending HIP packet on UDP socket
Sat Apr 20 14:37:03 2019 (1) Received HIP_R1 packet from 192.168.100.3 on udp socket length 640
 R1 TLV type = 128 length = 12 
 R1 TLV type = 257 length = 12 
 R1 TLV type = 513 length = 195 
 R1 TLV type = 577 length = 12 
 R1 TLV type = 705 length = 150 
Found RSA HI with public modulus: 0x d0950d51 c3f69360 ea4bfeb7 e2e9bc8e
5c70e2e4 b6d6a42b 3858bbc8 74fffc5e
0528ae6d c5d622d5 3aee20d8 e9c58e26
9659228b 21e4449d b51199c5 b5a86dc9
af5e19cc 89cb2b73 885206a8 bcb2d2f7
259a05e7 be9cf8a1 21551774 2036e4bd
c1ec4cc6 df411b79 baf78701 3d7f0d5b
ca07500b d5d2eb51 0472b707 f08b32f3
HI has name: jokey-1024 length: 10
HI in R1 validates the sender's HIT.
 R1 TLV type = 4095 length = 14 
 R1 TLV type = 61633 length = 129 
SHA1:  d88d6e47 da729a99 13ec765a cbf3e9a2 4a04d72f
RSA HIP signature is good.
 R1 TLV type = 128 length = 12 
 R1 TLV type = 257 length = 12 
Got the R1 cookie: (k=10 lifetime=39 (128 seconds) opaque=0 I=0x5f596ca9f2d597ba)
 R1 TLV type = 513 length = 195 
Got DH public value of len 192: 0x d566d32f a53508c5 7460f129 bd766ffe
855a3945 88025b19 ea817a09 6db6f141
0e537c72 b8cb5e84 b1f4fe48 a1f765bb
b3e2e941 031b6217 4a875c46 80a87953
6868104e 8ca01b9b 5c64e321 b4741d8f
654f316b 57a576e6 df178884 3e685d23
172cb0e8 dc5ba0fc 1abbeec7 eef4f97e
d27532f1 a5c06dc5 0fc39df0 d5be2b37
5ca0ad1d 511bdb88 4be0466f 6d9d0748
4d304722 d2820a0c 5064e390 8ba826fc
78317a23 d31ea29a 095c81c2 c4319f98
33453c7f ad2f86e8 3cdacb53 006ce1ab
    PKCS#3 DH Parameters: (1536 bit)
        prime:
            00:ff:ff:ff:ff:ff:ff:ff:ff:c9:0f:da:a2:21:68:
            c2:34:c4:c6:62:8b:80:dc:1c:d1:29:02:4e:08:8a:
            67:cc:74:02:0b:be:a6:3b:13:9b:22:51:4a:08:79:
            8e:34:04:dd:ef:95:19:b3:cd:3a:43:1b:30:2b:0a:
            6d:f2:5f:14:37:4f:e1:35:6d:6d:51:c2:45:e4:85:
            b5:76:62:5e:7e:c6:f4:4c:42:e9:a6:37:ed:6b:0b:
            ff:5c:b6:f4:06:b7:ed:ee:38:6b:fb:5a:89:9f:a5:
            ae:9f:24:11:7c:4b:1f:e6:49:28:66:51:ec:e4:5b:
            3d:c2:00:7c:b8:a1:63:bf:05:98:da:48:36:1c:55:
            d3:9a:69:16:3f:a8:fd:24:cf:5f:83:65:5d:23:dc:
            a3:ad:96:1c:62:f3:56:20:85:52:bb:9e:d5:29:07:
            70:96:96:6d:67:0c:35:4e:4a:bc:98:04:f1:74:6c:
            08:ca:23:73:27:ff:ff:ff:ff:ff:ff:ff:ff
        generator: 2 (0x2)
************
DH secret key set to:
0x b26998e0 35e326c5 3e0058ce 2613be32
1a658086 315a34e0 d54e4b2b ba0be737
9c58c751 90f1ef4c 2e997d48 f6075068
86142464 13cc00d6 830946f2 406918a5
03ccb09e d41f70ba 19e3600d 3fb5edd9
42094a17 f43a2d29 b1fa436e 9cae4714
8aee7d60 2e92181c d6aa71a5 3b76fd99
b33f5722 55f5de9d 06d2e5c2 7650c74f
b4ba4b03 933acb64 ea5447f7 3afcfe46
13b1414d 60fbd824 5b367bdc 60addff8
16dd3475 53aaf268 c1971b73 58ebe1cd
f58a918f b6d89116 2288c83c 6713fc8b
***********
 R1 TLV type = 577 length = 12 
 R1 TLV type = 705 length = 150 
 R1 TLV type = 4095 length = 14 
 R1 TLV type = 61633 length = 129 
Using cookie from R1: (k=10 lifetime=39 (128 seconds) opaque=0 I=0x5f596ca9f2d597ba)
Calculating Ltrunc(SHA1(I|Rand),K)...found match in 1143 tries (~0 seconds).
MD= 3cb3ad18 10c946a0 e5253374 25616d8e 082e8800
IJ= ba97d5f2 a96c595f 2001001e 4aef5a38
f3978f52 b607bad5 20010011 9856d864
d13d0411 001422ce 114ccdcd 405bf16e
Sending the I2 cookie: (k=10 lifetime=39 (128 seconds) opaque=0 I=0x5f596ca9f2d597ba)
solution: 0x6ef15b40cdcd4c11
Using HIP transform of 1.
Drawing new HIP encryption/integrity keys:
Key 0 (1,16) keymat[  0] 0x b3145b8c d2e2a8ff 382fc385 4373059a
Key 1 (1,20) keymat[ 16] 0x 40238da4 16f7d07c d62d8a15 fcbcd523 279445d3
Key 2 (1,16) keymat[ 36] 0x 8d4cef31 1ea9af67 a7681fd3 669293ab
Key 3 (1,20) keymat[ 52] 0x e917ce5b 7714d56e c5c743c7 75492550 c351fc26
Using DH public value of len 192: 0x 6d35ff67 fc11a417 d28c1432 f2df07ed
d5ab3ecf 424a0caf 0d81d471 003886aa
9a2ba7ad a16a4ccb 803f9511 3515b10a
bfa02dd0 6796835b 784b0153 af7c530d
abc099d9 5fd38492 0f629b79 688bb788
822c24a5 fd20eced f0281d70 4c629149
56267017 141d61bc 5cabe2f3 e785ebdf
ff45ce3b b6195195 bd2fdc05 15d96153
e22a997f cd65085e fad0f71a b78d8f12
40197fbd c58690d9 530636de 413e9f08
b708423f 8ee6a21b d3a421b8 80818076
bb55dfdb cc3b7a20 110277a1 2a05d918
AES encryption key: 0x b3145b8c d2e2a8ff 382fc385 4373059a
Encrypting 160 bytes using AES.
HMAC computed over 496 bytes hdr length=61
 SHA1:  cfafef72 5d3bf9ee 3e76d11c d305dee8 a99463fe
Signature:  7630e6dc d176eb80 eaac5afe 758a6563
6bfa1744 3b17aea8 95b76c7f ae6021b9
3bf95930 00a9c5ba 86e042fd d891d86e
35242762 351ab0c6 e0a84be5 a58783e3
9487a5d6 bd990fcf 45f0bfc8 2174f197
354d4a5a ccd966af 7a4c6eb9 a376c49f
eba6f1ba 22f97919 79af4bcc 69de0bac
18621904 8db836fb 471f97f4 a4c084c5
Sat Apr 20 14:37:03 2019 (1) Sending HIP_I2 packet (656 bytes)...
Sat Apr 20 14:37:03 2019 (1) Sending HIP packet on UDP socket
Sat Apr 20 14:37:03 2019 (1) Sent I2 (668 bytes)
Sat Apr 20 14:37:03 2019 (1) Received HIP_R2 packet from 192.168.100.3 on udp socket length 248
 R2 TLV type = 65 length = 12 
 R2 TLV type = 61569 length = 20 
 R2 TLV type = 61697 length = 129 
HMAC_2 verify over 216 bytes. hdr length=26 
HMAC_2 verified OK.
SHA1:  bd095ce9 ad2b9e14 88925184 d0d23ed8 8d860807
RSA HIP signature is good.
Using HIP transform of 1 ESP transform of 1.
Drawing new ESP keys from keymat index 72:
Key 4 (1,16) keymat[ 72] 0x d1cb4e0d c9e0b02f fcefc888 dd85da98
Key 5 (1,20) keymat[ 88] 0x d20520c9 56290f57 77ce5b57 9d16dd4d d5fed045
Key 6 (1,16) keymat[108] 0x d01960f6 feadb5e7 85ff3bfd 63aca116
Key 7 (1,20) keymat[124] 0x 95e02a97 237784bc 6d5ee8a4 23f488b9 c9b18a16
---------- HIP exchange complete. ----------
Sat Apr 20 14:37:03 2019 (1) Adding security association:
	src ip = 192.168.100.2 dst ip = 192.168.100.3
	SPIs in = 0xced1e76f out = 0x187b7d0a
Sat Apr 20 14:37:03 2019 (4) Base exchange completed from 
	2001:1e:4aef:5a38:f397:8f52:b607:bad5 / 192.168.100.2 / 1.7.186.213 to 
	2001:11:9856:d864:d13d:411:14:22ce / 192.168.100.3 / 1.20.34.206
Retransmitting 1 user data packets for 1.20.34.206.
