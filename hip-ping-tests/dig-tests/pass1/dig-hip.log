OpenHIP v0.9 HIP daemon
init_tap()
hip_status() thread started...
Using TAP device hip0.
Initialized TAP device.
Sat Apr 20 15:08:04 2019 (4) hipd v0.9 (1653) started.
Setting options: daemon = no  debug level = 1  permissive = no
     no_retransmit = no  opportunistic = no any = no rvs = no mr = no
Using configuration file:	/usr/local/etc/hip/hip.conf
Using my host IDs file:		/usr/local/etc/hip/my_host_identities.xml
tunreader() thread started (3)...
My host identities:
 HI: dig-1024 HIT: 2001:1e:4aef:5a38:f397:8f52:b607:bad5
	LSI: 1.7.186.213 
Using known host IDs file:	/usr/local/etc/hip/known_host_identities.xml
hip_esp_input() thread started...
Known peer host identities:
 HIT: jokey-1024  2001:11:9856:d864:d13d:411:14:22ce
	LSI: 1.20.34.206 [192.168.100.3 ]
 HIT: adam-desktop-1024  2001:1b:574c:56ab:6498:6726:a858:35ea
	LSI: 1.88.53.234 [192.168.4.89 ]
Local addresses: (1)127.0.0.1 (4)192.168.100.2 (1)::1 (4)fe80::20d:b9ff:fe42:73b6 
192.168.100.2 selected as the preferred address (first in list).
Initializing R1 cache entries for identity dig-1024 (8 slots).
Adding address 1.7.186.213 to interface 12.
Adding address 2001:1e:4aef:5a38:f397:8f52:b607:bad5 to interface 12.
hip_esp_output() thread started...
Sat Apr 20 15:08:05 2019 (1) Listening for HIP control packets...
Sat Apr 20 15:08:06 2019  HIP threads initialization completed.
Sat Apr 20 15:08:18 2019 (1) Received HIP_I1 packet from 192.168.100.3 on udp socket length 72
Using premade R1 from dig-1024 cache slot 1.
Sat Apr 20 15:08:18 2019 (1) Sending HIP_R1 packet (600 bytes)...
Sat Apr 20 15:08:18 2019 (1) Sending HIP packet on UDP socket
Sat Apr 20 15:08:18 2019 (1) Sent R1 (612 bytes)
Sat Apr 20 15:08:18 2019 (1) Received HIP_I2 packet from 192.168.100.3 on udp socket length 688
 I2 TLV type = 65 length = 12 
 I2 TLV type = 128 length = 12 
R1 counter 11 (11) acceptable.
 I2 TLV type = 321 length = 20 
Got the I2 cookie: (k=10 lifetime=39 (128 seconds) opaque=0 I=0x9ccac5570adf7667)
solution: 0xd588c8a699777015
Verifying cookie to 10 bits
Cookie verified ok.
 I2 TLV type = 513 length = 195 
Got DH public value of len 192: 0x 9383f764 94f60df7 365b5f99 cc9aa18b
d77e7719 d7009a1f 9c337308 8d0f2b5b
e6712588 460481ab 3646136d c1ef40d0
eb48ba80 514db4ac 31bf6499 c4d3bd5d
5e1901f3 748215fb eecbd567 46e12837
38225482 0638a781 fa0711ce 18d98fd2
ce95a00b 3625bbb9 eb5f2964 a1303f13
7c89e492 24df9637 00fc7dba a94041f9
801f5192 9f59531f f7631127 d771d839
af0860b1 232ceb41 251257d3 08c23534
3e3f2a3a 3c349650 2553b349 c56379e2
027e1759 b735d8dc 1bd132ed fa81b0fb
************
DH secret key set to:
0x 0c9d2f90 28d6316e eedfb017 b463d06f
475803a5 3f804605 554865ac bfec9b07
20aa72fe fdfe294a f9c61671 b26b449a
14918b2d 65b4479d d54b2a0d 996cb328
e2738fd0 d773914d 340d7026 914fb72e
c19976cb 58ada094 808d667b a59f0038
9aed14d7 8567dc9d c70e0d0b 3107f140
adf6b2fa fc425099 fbc82623 1fe95201
787a4a8f 1c25e162 ffea52fa 1593cfe9
3575b584 4bb63642 ad8dfb8a 0fffbfc9
71997624 8f8a2f52 d5a12deb a7bda425
3ea563b4 70b2a320 1ab085ea b057ccab
***********
 I2 TLV type = 577 length = 2 
Using HIP transform of 1.
Drawing new HIP encryption/integrity keys:
Key 0 (1,16) keymat[  0] 0x e86c2fc8 ee62ef4a 5c131c1b 59f9f7e2
Key 1 (1,20) keymat[ 16] 0x 45431a76 2d2bda89 8fd7269d 9d52a23d bd4ea51f
Key 2 (1,16) keymat[ 36] 0x 985603ef cb15b200 b53a6cd7 ed3c80a5
Key 3 (1,20) keymat[ 52] 0x b30f3ac3 8ec7d597 ff2854c0 836f4d5e 9cecadd1
 I2 TLV type = 641 length = 180 
AES decryption key: 0x 985603ef cb15b200 b53a6cd7 ed3c80a5
Decrypting 160 bytes using AES.
Found RSA HI with public modulus: 0x d0950d51 c3f69360 ea4bfeb7 e2e9bc8e
5c70e2e4 b6d6a42b 3858bbc8 74fffc5e
0528ae6d c5d622d5 3aee20d8 e9c58e26
9659228b 21e4449d b51199c5 b5a86dc9
af5e19cc 89cb2b73 885206a8 bcb2d2f7
259a05e7 be9cf8a1 21551774 2036e4bd
c1ec4cc6 df411b79 baf78701 3d7f0d5b
ca07500b d5d2eb51 0472b707 f08b32f3
HI has name: jokey-1024 length: 10
HI in I2 validates the sender's HIT.
 I2 TLV type = 4095 length = 4 
 I2 TLV type = 61505 length = 20 
HMAC verify over 496 bytes. hdr length=61 
HMAC verified OK.
 I2 TLV type = 61697 length = 129 
SHA1:  7c52a627 570dcf93 ab877726 0635a2ec d69ce604
RSA HIP signature is good.
Adding address 192.168.100.2 to association.
HMAC computed over 208 bytes hdr length=25
 SHA1:  ef338f0b b227b997 d554cbcd 12e91f56 f3339de5
Signature:  7d85214a fe608187 d619c2b2 5ed608f5
b705869b a5883731 c13ec28d 74fa640d
87ef90fe 2bbd1696 c04aa67a 92dc443e
c53df7c1 e51d4d68 4a9ea164 6d872843
34251ace f878975d 70165a33 68703fcc
567bb3fb 0a279b38 de571068 a3c80877
59b8a052 da435531 82cc4e95 766ce666
efd6f078 d86dd904 dd7d0ad7 b38c0b7a
Sat Apr 20 15:08:18 2019 (1) Sending HIP_R2 packet (216 bytes)...
Sat Apr 20 15:08:18 2019 (1) Sending HIP packet on UDP socket
Using HIP transform of 1 ESP transform of 1.
Drawing new ESP keys from keymat index 72:
Key 4 (1,16) keymat[ 72] 0x 577bc20c c2cc5adb 2a0fef3b 98540991
Key 5 (1,20) keymat[ 88] 0x f9334a37 1e74052e 67acf1e9 28080617 fc0f2423
Key 6 (1,16) keymat[108] 0x 435ad05b 09e4ca05 eeb04a53 d6967090
Key 7 (1,20) keymat[124] 0x 50da9afb 1fcfa0f2 7b7222ef cd5bacac c75df674
Sent R2 (228 bytes)
---------- HIP exchange complete. ----------
Sat Apr 20 15:08:18 2019 (1) Adding security association:
	src ip = 192.168.100.2 dst ip = 192.168.100.3
	SPIs in = 0x7179ccc6 out = 0xc651fce8
Sat Apr 20 15:08:18 2019 (4) Base exchange completed from 
	2001:1e:4aef:5a38:f397:8f52:b607:bad5 / 192.168.100.2 / 1.7.186.213 to 
	2001:11:9856:d864:d13d:411:14:22ce / 192.168.100.3 / 1.20.34.206
Sat Apr 20 15:08:19 2019 (1) HIP association 0 moved from R2_SENT=>ESTABLISHED due to incoming ESP data.
