OpenHIP v0.9 HIP daemon
hip_status() thread started...
init_tap()
Sat Apr 20 16:44:10 2019 (4) hipd v0.9 (2113) started.
Setting options: daemon = no  debug level = 1  permissive = no
     no_retransmit = no  opportunistic = no any = no rvs = no mr = no
Using configuration file:	/usr/local/etc/hip/hip.conf
Using my host IDs file:		/usr/local/etc/hip/my_host_identities.xml
My host identities:
 HI: jokey-1024 HIT: 2001:11:9856:d864:d13d:411:14:22ce
	LSI: 1.20.34.206 
Using TAP device hip0.
Initialized TAP device.
Using known host IDs file:	/usr/local/etc/hip/known_host_identities.xml
Known peer host identities:
 HIT: dig-1024  2001:1e:4aef:5a38:f397:8f52:b607:bad5
	LSI: 1.7.186.213 [192.168.100.2 ]
hip_esp_input() thread started...
tunreader() thread started (4)...
Local addresses: (1)127.0.0.1 (4)192.168.100.3 (1)::1 (4)fe80::20d:b9ff:fe4e:c40e 
192.168.100.3 selected as the preferred address (first in list).
hip_esp_output() thread started...
Initializing R1 cache entries for identity jokey-1024 (8 slots).
Adding address 1.20.34.206 to interface 14.
Adding address 2001:11:9856:d864:d13d:411:14:22ce to interface 14.
Sat Apr 20 16:44:11 2019 (1) Listening for HIP control packets...
Sat Apr 20 16:44:12 2019  HIP threads initialization completed.
Sat Apr 20 16:44:24 2019 (1) Received HIP_I1 packet from 192.168.100.2 on udp socket length 72
Using premade R1 from jokey-1024 cache slot 6.
Sat Apr 20 16:44:24 2019 (1) Sending HIP_R1 packet (608 bytes)...
Sat Apr 20 16:44:24 2019 (1) Sending HIP packet on UDP socket
Sat Apr 20 16:44:24 2019 (1) Sent R1 (620 bytes)
Sat Apr 20 16:44:24 2019 (1) Received HIP_I2 packet from 192.168.100.2 on udp socket length 688
 I2 TLV type = 65 length = 12 
 I2 TLV type = 128 length = 12 
R1 counter 11 (11) acceptable.
 I2 TLV type = 321 length = 20 
Got the I2 cookie: (k=10 lifetime=39 (128 seconds) opaque=0 I=0xd853059060dfa67)
solution: 0x502aa3eddf973813
Verifying cookie to 10 bits
Cookie verified ok.
 I2 TLV type = 513 length = 195 
Got DH public value of len 192: 0x 10fe4406 a57dd101 cb281fee 6e5f7215
0a694d3a c1d11895 2288424c f9373206
89c8c29d 5c8b051c 4fec9ba6 1b4a3320
fc92756e 8a2bee42 b615d778 3901734a
34722ed1 d737a148 05108d0c 3e5f3751
f1b79ab8 b958ce04 50bc4790 e48a1c76
d1d310c1 ad8990b6 13b1e30c 9dcdec90
cb200657 aeace488 d5a53736 ac890996
d444074e 0e80edf0 a0086fd7 bab881b8
62b0dc56 0f83fe65 c8985498 9feceac1
39089a0e 416b551a 2f89dd0c 7deced13
3b16181b 78d069b1 952ab3b4 42ef431e
************
DH secret key set to:
0x 131faec6 a3177730 3e09588b 0f70c78e
372ed832 14d59078 146e8dcf 26dfbf5e
e55a6bfa c86fd536 e3286f04 e222716d
1ff86b03 0d02438e ddebc599 7c30b372
3d3a992f e8715bfb 977f1ad8 8b259e68
4237fabc a2a12ded f310d5bd b74b30c3
96198e65 cc42be9f 509beaa1 d4c024c1
50ac416b 7699e181 3cd7ed42 75004ab4
5f430a17 af9ca4dd c39f3eb2 802d838c
6b3b69fd 18762003 2f14946c 868ce3bd
549d4659 1209f6b3 cf523c86 a611c7b8
ab76360c 1913faa9 7a96126c d57324c3
***********
 I2 TLV type = 577 length = 2 
Using HIP transform of 1.
Drawing new HIP encryption/integrity keys:
Key 0 (1,16) keymat[  0] 0x 1c1bd5bb ff42833d 7f4933e9 7c505a1a
Key 1 (1,20) keymat[ 16] 0x dd742d25 ec0a61f5 1738c006 e65a38a8 54c2223e
Key 2 (1,16) keymat[ 36] 0x 50cc4c90 9fe4315f a0fb2a46 cd03be34
Key 3 (1,20) keymat[ 52] 0x 9255e48f f2cdb68f 81db1242 a65cb630 1fd9083e
 I2 TLV type = 641 length = 180 
AES decryption key: 0x 1c1bd5bb ff42833d 7f4933e9 7c505a1a
Decrypting 160 bytes using AES.
Found RSA HI with public modulus: 0x d096ff3a 741d69a5 dafd002f cd728600
19bcfbff cb773fb8 2f183739 0064c249
84f6372c 8da5d309 c6aeec59 417799ad
5e024508 d4dbd882 f40b018c 1f806915
848c08de 859d8136 278700b3 92d5285d
ed9aef77 a80d0b21 9e9f9fe4 2454622e
38321704 dc8ba4d5 98383a2e 2b2e41fa
881d82ac da840552 f3ecf20e 7d5f322d
HI has name: dig-1024 length: 8
HI in I2 validates the sender's HIT.
 I2 TLV type = 4095 length = 4 
 I2 TLV type = 61505 length = 20 
HMAC verify over 496 bytes. hdr length=61 
HMAC verified OK.
 I2 TLV type = 61697 length = 129 
SHA1:  4dafdf38 82b66c20 1a81a9ec 9b72b56d 0749bbb4
RSA HIP signature is good.
Adding address 192.168.100.3 to association.
HMAC computed over 216 bytes hdr length=26
 SHA1:  b8e95206 54712f68 b18bd12f 23515a4d f6cd0b76
Signature:  449f53b4 551801f0 cee01714 b69d8c55
29c15059 2363e3ec b7d525e8 077e4b83
bd7e43d9 9dca73b3 4fffb871 b4a77ee7
03810de2 e3b7569a 95b983a5 efe5e86c
889bdce3 1b2f8f94 9edf7d58 c5757520
52614165 4fa61633 c6999332 4d43cdad
2dae2d64 9125a604 8fb2d28d af4cd8ac
dc4b36d7 652f1feb eb9532a4 37747e0a
Sat Apr 20 16:44:24 2019 (1) Sending HIP_R2 packet (216 bytes)...
Sat Apr 20 16:44:24 2019 (1) Sending HIP packet on UDP socket
Using HIP transform of 1 ESP transform of 1.
Drawing new ESP keys from keymat index 72:
Key 4 (1,16) keymat[ 72] 0x 337a63ed ac03925a ee0b0c19 08d4c39c
Key 5 (1,20) keymat[ 88] 0x dd396a2f 7367a959 f8d08deb bc957e53 6643a728
Key 6 (1,16) keymat[108] 0x f291c53d ce339428 a9741db5 8c596b32
Key 7 (1,20) keymat[124] 0x ce53d5b9 b2bb2eda c467bb4d 6302e049 91a7bf6b
Sent R2 (228 bytes)
---------- HIP exchange complete. ----------
Sat Apr 20 16:44:24 2019 (1) Adding security association:
	src ip = 192.168.100.3 dst ip = 192.168.100.2
	SPIs in = 0x2969d240 out = 0x83645de4
Sat Apr 20 16:44:24 2019 (4) Base exchange completed from 
	2001:11:9856:d864:d13d:411:14:22ce / 192.168.100.3 / 1.20.34.206 to 
	2001:1e:4aef:5a38:f397:8f52:b607:bad5 / 192.168.100.2 / 1.7.186.213
Sat Apr 20 16:44:25 2019 (1) HIP association 0 moved from R2_SENT=>ESTABLISHED due to incoming ESP data.
